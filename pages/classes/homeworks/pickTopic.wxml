<wxs module="split">
    var blank = function(str) {
        str = str||''
        return str.split('##')
    }
    var blanklength = function(str) {
        return str.replace('blank','')
    }
    var isInArr = function(str,arr) {
        var arrStr = arr.toString()
        return arrStr.indexOf(str) != -1
        
    }
    var instead = function(str) {
        while (str.indexOf('##break##') != -1) {
            str = str.replace('##break##','\n')
        }
        while (str.indexOf('##blank##') != -1) {
            str = str.replace('##blank##','______')
        }
        str = str.replace('【点评】','\n【点评】')
        str = str.replace('【分析】','\n【分析】')
        return str
    }
    module.exports = {
    blank: blank,
    blanklength: blanklength,
    isInArr:isInArr,
    instead:instead
};
</wxs>
<scroll-view class="cu-card" scroll-y="{{true}}" scroll-into-view="t{{index}}" style="padding-bottom:200rpx;">
    <view class="cu-item shadow padding-xs margin">
        <view class='flex justify-between'>
            <view class='flex '>
                <picker bindchange="formInputChange" data-field="difficulty" data-type="picker" value="{{difficulty}}" data-range="{{difficulties}}" range="{{difficulties}}" range-key="name">
                    <view class="text-sm margin-right">
                        {{difficulties[difficulty].name}}难度
                        <text class='cuIcon-unfold text-blue '></text>
                    </view>
                </picker>
                <picker bindchange="formInputChange" data-field="questionType" data-type="picker" value="{{questionType}}" data-range="{{questionTypes}}" range="{{questionTypes}}" range-key="name">
                    <view class="text-sm margin-right">
                        {{questionType>0?questionTypes[questionType].name:'全部题型'}}
                        <text class='cuIcon-unfold text-blue '></text>
                    </view>
                </picker>
            </view>
            <view class='action'>
                <button class="cu-btn round sm bg-blue" aira-disabled="false" bindtap="inti">
                    筛选
                </button>
            </view>
        </view>
    </view>
    <view class="padding-bottom-lg padding-lr-lg">
        <view class="flex align-center">
            <text class="text-sp text-bold">题目列表：</text>
            <view class="cu-tag bg-blue light round text-bold">{{recordCount}}题</view>
        </view>
    </view>
    <view class="padding-lr-lg">
        <checkbox-group class="block" data-field="questionIds" bindchange="formInputChange">
            <block wx:for="{{list}}" wx:key="topic">
                <view class="radius-sp bg-white margin-bottom-sm padding-top padding-lr-lg padding-bottom" id="t{{index}}">
                    <view class="flex align-center margin-bottom-lg justify-between">
                        <text class="text-sm colorF-sp">{{item.questionTypeName}}</text>
                        <checkbox class="round blue" checked="{{split.isInArr(item.id,hasPickQuestionIds)}}" value="{{index}}" data-id="{{item.id}}" data-question="{{item}}" bind:tap="checkbox"></checkbox>
                    </view>
                    <view class="padding-sm flex flex-wrap justify-start align-center panel margin-bottom">
                        <view wx:if="{{item.questionType == 3}}" class="flex-sub topic text-sm colorF-sp">
                            <text>{{split.instead(item.title)}}</text>
                        </view>
                        <rich-text wx:else nodes="{{item.title}}" class="flex-sub topic text-sm colorF-sp"></rich-text>
                    </view>
                    <view class="margin-bottom flex align-center">
                        <view class="text-sp label">题目难度</view>
                        <image mode="widthFix" wx:for="{{item.difficulty}}" wx:key="*this" src="{{imgUrl}}star_active.png" style="width:28rpx;margin-right:12rpx" />
                        <image mode="widthFix" wx:for="{{5 - item.difficulty}}" wx:key="*this" src="{{imgUrl}}star_default.png" style="width:28rpx;margin-right:12rpx" />
                    </view>
                    <view class="margin-bottom flex align-start">
                        <view class="text-sp label">知识点</view>
                        <view class="flex-sub flex flex-wrap align-center">
                            <block wx:if="{{item.knowledges.length>0}}">
                                <view class="round cu-tag bg-blue light margin-right-xs margin-bottom-xs;" wx:for="{{item.knowledges}}" wx:for-item="knowledge" wx:key="knowledge" style="margin-left:0;">
                                    {{knowledge.title}}
                                </view>
                            </block>
                            <view wx:else class="round cu-tag bg-blue light">无</view>
                        </view>
                    </view>
                </view>
            </block>
        </checkbox-group>
    </view>
</scroll-view>
<view class="cu-bar bg-white tabbar border shop foot">
    <view class="btn-group">
        <button class="cu-btn lg bg-white flex-sub" bind:tap="back">返回</button>
        <button class="cu-btn lg bg-blue sp margin-right" bind:tap="pick" disabled="{{hasPickQuestionIds.length==0}}">
            预览(已选{{hasPickQuestionIds.length}}题)
        </button>
    </view>
</view>