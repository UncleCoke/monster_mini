<wxs module="split">
    var blank = function (str) {
        str = str || ''
        return str.split('##')
    }
    var blanklength = function (str) {
        return str.replace('blank', '')
    }
    var isBlank = function (str) {
        return str.indexOf('blank') != -1
    }
    var instead = function (str) {
        while (str.indexOf('##break##') != -1) {
            str = str.replace('##break##', '\n')
        }
        while (str.indexOf('##blank##') != -1) {
            str = str.replace('##blank##', '______')
        }
        str = str.replace('【点评】', '\n【点评】')
        str = str.replace('【分析】', '\n【分析】')
        return str
    }
    module.exports = {
        blank: blank,
        blanklength: blanklength,
        isBlank: isBlank,
        instead: instead
    };
</wxs>
<view class="page-sp">
    <view class="bg-white padding-lg">
        <view class="flex align-center justify-between">
            <view class="flex align-center">
                <view class="cu-avatar round lg" style="background-image:url({{user.imgUserAvatar}});"></view>
                <view class="margin-left-sm">
                    <view class="text-sp">{{user.nickName}}</view>
                    <view class="colorT-sp text-sm flex justify-between margin-top-sm">
                        {{user.phone}}
                    </view>
                </view>
            </view>
        </view>
    </view>
    <view class="bg-white margin-top-sm padding-lg">
        <view class="flex align-center">
            <image src="{{imgUrl}}icon_hw.png" style="width:32rpx" mode="widthFix" />
            <view class="text-sp text-bold margin-left-sm">作业情况</view>
        </view>
        <view class="margin-top-lg flex align-center justify-between">
            <view class="time-box">
                <view class="text-xl text-bold text-white">{{report.homework.spendTime}}</view>
                <view class="margin-top-xs text-sm">我的用时</view>
            </view>
            <view class="time-box" style="background:url('{{evalImgUrl}}report/bg_AllTime .png');background-size:320rpx 160rpx;">
                <view class="text-xl text-bold text-white">{{report.homework.score}}分</view>
                <view class="margin-top-xs text-sm">我的得分</view>
            </view>
        </view>
    </view>
    <view class="bg-white margin-top-sm padding-lg">
        <view class="flex align-center">
            <image src="{{imgUrl}}icon_knowledge.png" style="width:32rpx" mode="widthFix" />
            <view class="text-sp text-bold margin-left-sm">以下知识点有待加强练习</view>
        </view>
        <view class="flex flex-wrap padding-bottom-xs">
            <block wx:for="{{report.knowledgeData}}" wx:key="knowledgeData" wx:if="{{item.tips == '待提高'}}">
                <view class="cu-tag bg-blue light round margin-lr-xs margin-top">
                    {{item.title}}
                </view>
            </block>
        </view>
    </view>
    <view class="bg-white margin-top-sm padding-lg">
        <view class="flex align-center margin-bottom-lg">
            <image src="{{imgUrl}}icon_record.png" style="width:32rpx" mode="widthFix" />
            <view class="text-sp text-bold margin-left-sm">答题记录</view>
        </view>
        <view class="grid col-4">
            <view class="padding-xs" wx:for="{{report.questionList}}" wx:key="topic">
                <view class="cu-capsule round" data-index="{{index}}" bind:tap="viewTopic" style="height:64rpx;">
                    <view class="cu-tag bg-{{item.isCorrect?'olive':'red'}}" style="width:56rpx;height:64rpx;">
                        <text class="cuIcon-{{item.isCorrect?'check':'close'}}" style="font-size:30rpx;font-weight:bold"></text>
                    </view>
                    <view class="cu-tag line-{{item.isCorrect?'olive':'red'}}" style="width:96rpx;height:64rpx;">
                        第{{index+1}}题
                    </view>
                </view>
            </view>
        </view>
    </view>
    <view class="padding-lg">
        <view class="flex align-center margin-bottom-lg">
            <image src="{{imgUrl}}icon_list.png" style="width:34rpx" mode="widthFix" />
            <view class="text-sp text-bold margin-left-sm">题目列表</view>
        </view>
        <block wx:for="{{report.questionList}}" wx:key="topic">
            <view class="radius-sp bg-white margin-bottom-lg padding-top padding-lr-lg padding-bottom" id="t{{index}}">
                <view class="flex align-center margin-bottom-lg">
                    <view class="cu-tag bg-{{item.isCorrect?'green':'red'}} round margin-right-sm">
                        第{{index+1}}题
                    </view>
                    <text class="text-sm colorF-sp">{{item.questionTypeName}}</text>
                </view>
                <view class="padding-sm flex flex-wrap justify-start align-center panel margin-bottom">
                    <view wx:if="{{item.questionType == 3}}" class="flex-sub topic text-sm colorF-sp">
                        <text>{{split.instead(item.title)}}</text>
                    </view>
                    <rich-text wx:else nodes="{{item.title}}" class="flex-sub topic text-sm colorF-sp"></rich-text>
                </view>
                <view class="margin-bottom flex align-center">
                    <view class="text-sp label">题目难度</view>
                    <image mode="widthFix" wx:for="{{item.difficulty}}" wx:key="*this" src="{{evalImgUrl}}star_active.png" style="width:28rpx;margin-right:12rpx" />
                    <image mode="widthFix" wx:for="{{5 - item.difficulty}}" wx:key="*this" src="{{evalImgUrl}}star_default.png" style="width:28rpx;margin-right:12rpx" />
                </view>
                <view class="margin-bottom flex align-start">
                    <view class="text-sp label">知识点</view>
                    <view class="flex-sub flex flex-wrap align-center">
                        <block wx:if="{{item.knowledges.length>0}}">
                            <view class="round cu-tag bg-blue light margin-right-xs margin-bottom-xs;" wx:for="{{item.knowledges}}" wx:for-item="knowledge" wx:key="knowledge" style="margin-left:0;">
                                {{knowledge.title}}
                            </view>
                        </block>
                        <view wx:else class="round cu-tag bg-blue light">无</view>
                    </view>
                </view>
                <view class="margin-bottom flex align-start">
                    <view class="text-sp label">学生答案</view>
                    <view class="bg-{{item.isCorrect?'green':'red'}} light round  cu-tag" style="min-width:136rpx;">
                        <block wx:if="{{item.questionType == 1}}">
                            {{item.myAnswer>-1?topicOptions[item.myAnswer]:'无'}}
                        </block>
                        <block wx:else>{{item.myAnswer?item.myAnswer:'无'}}</block>
                    </view>
                </view>
                <view class="margin-bottom flex align-start">
                    <view class="text-sp label">正确答案</view>
                    <rich-text nodes="{{item.showAnswer}}" class="bg-blue light round  cu-tag" style="min-width:136rpx;"></rich-text>
                </view>
            </view>
        </block>
    </view>
</view>
<view class="cu-bar bg-white tabbar border shop foot">
    <view class="btn-group">
        <button class="cu-btn lg bg-blue submit margin-tb-sm margin-lr sp" bind:tap="back">
            返回
        </button>
    </view>
</view>
<wxs module="func">
    var showTime = function (time) {
        time = time * 1
        var showTime = ''
        var minute = Math.floor(time / 60)
        var second = time % 60
        if (minute > 0) {
            second = second < 10 ? '0' + second : second 
            showTime = minute + '分' + second + '秒'
        } else { showTime = second + '秒' } return showTime
    }
    var random = function (number) {
        number = number * 1 
        var randomNumber = number * Math.random()
        randomNumber = Math.floor(randomNumber) 
        return randomNumber
    } 
    var floor = function (number) {
        number = number * 1
        number = Math.floor(number) 
        return number
    } 
    module.exports.showTime = showTime 
    module.exports.random = random
    module.exports.floor = floor 
    </wxs>